<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quick Quote Widget Test</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    #test-container {
      max-width: 800px;
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <div id="test-container">
    <h1>Quick Quote Widget Test</h1>
    <p>Testing the widget with sample data...</p>
    <div id="widget-mount"></div>
  </div>

  <script>
    // Simulate the widget environment
    window.openai = {
      toolOutput: {
        zip_code: "90210",
        number_of_drivers: 2,
        city: "Beverly Hills",
        state: "California",
        best_case_range: {
          min: 1040,
          max: 1560,
          per_month_min: 173,
          per_month_max: 260
        },
        worst_case_range: {
          min: 3120,
          max: 4680,
          per_month_min: 520,
          per_month_max: 780
        },
        stage: "quick_quote_complete",
        is_placeholder: true
      }
    };

    console.log("Test: window.openai set", window.openai);
  </script>

  <!-- Load the widget HTML inline -->
  <script>
    fetch('/Users/alexanderleon/mi/openai-apps-sdk-examples/insurance_server_python/quick_quote_results_widget.py')
      .then(r => r.text())
      .then(content => {
        // Extract the HTML from the Python string
        const htmlMatch = content.match(/QUICK_QUOTE_RESULTS_WIDGET_HTML = """([\s\S]*?)"""/);
        if (htmlMatch) {
          const widgetHtml = htmlMatch[1];
          document.getElementById('widget-mount').innerHTML = widgetHtml;
          console.log("Widget HTML loaded and inserted");
        } else {
          console.error("Could not extract widget HTML");
          document.getElementById('widget-mount').innerHTML = '<p>Error loading widget</p>';
        }
      })
      .catch(err => {
        console.error("Error loading widget:", err);
        document.getElementById('widget-mount').innerHTML = '<p>Error: ' + err.message + '</p>';
      });
  </script>
</body>
</html>
